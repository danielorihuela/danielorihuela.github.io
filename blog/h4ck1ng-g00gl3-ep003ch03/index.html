<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/me.svg"><meta name="generator" content="Astro v5.12.7"><!-- Canonical URL --><link rel="canonical" href="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep003ch03/"><!-- Primary Meta Tags --><title>H4ck1ng G00gl3 ep003 challenge 03</title><meta name="title" content="H4ck1ng G00gl3 ep003 challenge 03"><meta name="description" content="Hack your way through H4ck1ng G00gl3 ep003 challenge 03. Decompile, modify the apk, and scan the QR code to reveal the hidden flag."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep003ch03/"><meta property="og:title" content="H4ck1ng G00gl3 ep003 challenge 03"><meta property="og:description" content="Hack your way through H4ck1ng G00gl3 ep003 challenge 03. Decompile, modify the apk, and scan the QR code to reveal the hidden flag."><meta property="og:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep003ch03/"><meta property="twitter:title" content="H4ck1ng G00gl3 ep003 challenge 03"><meta property="twitter:description" content="Hack your way through H4ck1ng G00gl3 ep003 challenge 03. Decompile, modify the apk, and scan the QR code to reveal the hidden flag."><meta property="twitter:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- RSS --><link rel="alternate" type="application/rss+xml" title="Daniel Orihuela" href="https://danielorihuela.dev/feed.xml"><link rel="stylesheet" href="https://danielorihuela.dev/_astro/about.BFXsSlim.css">
<link rel="stylesheet" href="https://danielorihuela.dev/_astro/_slug_.D6TxBt9f.css">
<style>img{margin:0 auto}div+h1{margin-top:0}h1,h2,h3,h4,h5,h6{margin-top:1em}
</style></head> <body class="bg-black bg-gradient-to-b from-black to-gray-900w-screen bg-black bg-gradient-to-b from-black to-gray-900"> <header class="px-4 py-0"> <nav class="fixed top-0 left-0 right-0 z-50 transition-all duration-500 bg-black/90 backdrop-blur-md border-b border-royalPurple/50"> <div class="max-w-7xl mx-auto px-6 lg:px-8"> <div class="flex items-center justify-between h-20">  <a href="/" class="text-2xl font-bold text-white hover:text-cyan-400 transition-colors duration-300"> <span class="text-royalPurple">&lt;</span>
DO
<span class="text-royalPurple">/&gt;</span> </a>  <div class="hidden md:flex items-center space-x-8"> <a href="/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Home <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/about/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> About <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/blog/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Blog <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/open-source/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Open Source <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a> </div>  <button id="mobile-menu-button" class="md:hidden text-white hover:text-cyan-400 transition-colors duration-300"> <svg id="menu-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"> <path id="menu-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path> </svg> </button> </div>  <div id="mobile-menu" class="md:hidden transition-all duration-300 overflow-hidden max-h-0 opacity-0"> <div class="py-4 space-y-2 bg-black/95 backdrop-blur-md rounded-lg mt-2 border border-purple-900/30"> <a href="/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Home </a><a href="/about/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> About </a><a href="/blog/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Blog </a><a href="/open-source/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Open Source </a> </div> </div> </div> </nav> <script type="module">document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("mobile-menu-button"),e=document.getElementById("menu-path");!n||!e||n.addEventListener("click",()=>{const t=document.getElementById("mobile-menu");t&&(t.classList.contains("max-h-0")?(t.classList.remove("max-h-0","opacity-0"),t.classList.add("max-h-96","opacity-100"),e.setAttribute("d","M6 18L18 6M6 6l12 12")):(t.classList.remove("max-h-96","opacity-100"),t.classList.add("max-h-0","opacity-0"),e.setAttribute("d","M4 6h16M4 12h16m-7 6h7")))})});</script> </header> <article class="my-32"> <div class="w-[80ch] max-w-full m-auto text-[#d3d3d3] bg-[#222222] rounded-2xl p-8 lg:p-12 border border-gray-600/30 shadow-2xl prose prose-xl prose-invert max-w-none"> <div class="w-96 max-w-full m-auto"> <img src="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H_1M1yFG.webp" alt loading="lazy" decoding="async" fetchpriority="auto" width="1024" height="1024" class="rounded-xl shadow-ba"> </div> <div class="py-4 text-center leading-none"> <div class="mb-2 text-[#ffffff]"> <time datetime="2022-11-13T00:00:00.000Z"> Nov 13, 2022 </time> </div> <h1 class="font-[Iceland]"> H4ck1ng G00gl3 ep003 challenge 03 </h1> <hr> </div>  <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#learning-journey">Learning Journey</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p><a href="https://h4ck1ng.google/">H4ck1ng G00gl3</a> is a series of security
challenges published on <strong>October 2022</strong> where the only way to win is to
think like a hacker. In this post, I explain how I solved <strong>ep003
challenge 03</strong>. Category <strong>Android</strong>.</p>
<h1 id="learning-journey">Learning Journey</h1>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="484" height="158" src="https://danielorihuela.dev/_astro/intro.CKtRuOxm_1oltDp.webp" ></p>
<p>Opening the challenge gives us a zip containing two files: an apk and a
QR code. First things first, let’s install the application and see if we
can scan the QR code and what’s the result.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="1080" height="2160" src="https://danielorihuela.dev/_astro/original-app.DS5e-6VT_Z1z5UJn.webp" ></p>
<p>The QR code returns the Secret flag data. However, it seems like we have
to be a subscriber to get the URL field where I guess the flag is
hidden. I’m pretty sure we can modify the apk in a way that shows us the
flag. To do that, we have to obtain the source code first. There is a
tool called <a href="https://github.com/pxb1988/dex2jar">dex2jar</a> that extracts
the jar file from the apk.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="929" height="66" src="https://danielorihuela.dev/_astro/apk-to-jar.CDiA7_Xp_130gBY.webp" ></p>
<p>Then, we can use <a href="https://java-decompiler.github.io/">jd-gui</a> to open
the jar file and look at the source code. Once we have it, there is no
trick. We have to read it and find where the vulnerability is. In that
case, I found <strong>the signature of the HTTP request was different between
a subscribed and an unsubscribed user</strong>.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="1266" height="470" src="https://danielorihuela.dev/_astro/jdgui-networkktclass.Dl9yCreU_qob4t.webp" ></p>
<p>I wondered how the application knew if a user was a subscriber. After
searching through the code, I found the <strong>“CorgiRequest” class with the
“isSubscriber” field</strong>, initialized in the constructor. In other words,
if we set the “isSubscriber” field to true when the class is created, we
might get the flag.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="964" height="511" src="https://danielorihuela.dev/_astro/jdgui-is-subscriber-field.CAsoPeJG_Z1AdP7I.webp" ></p>
<p>To modify the application, we are going to use the
<a href="https://github.com/APKLab/APKLab">APKLab</a> VsCode plugin. First, we are
going to decompile it.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="724" height="429" src="https://danielorihuela.dev/_astro/apklab-decompile-args-error.Cy81bXYT_Z1q62cW.webp" ></p>
<p>Decompiling the resources gave me an error, so I tried decompiling all
except the resources.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="1254" height="233" src="https://danielorihuela.dev/_astro/apklab-decompile-error-message.DctFumbM_Z1e4cbB.webp" ></p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="720" height="418" src="https://danielorihuela.dev/_astro/apklab-decompile-args.DUsMJHOL_Z1lF27W.webp" ></p>
<p>After decompiling it, we will have access to the code in the Smali
language. It’s a low-level language, and it’s harder to understand. We
know we have to modify the constructor class of the CorgiRequest class.
For that challenge, the change is tiny.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="1301" height="536" src="https://danielorihuela.dev/_astro/apklab-modification.7ORlggLz_2bw8r8.webp" ></p>
<p>Now we need to recompile the code into an apk and sign it.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="716" height="260" src="https://danielorihuela.dev/_astro/apklab-compile-sign.CKU7EaPy_Z17CBDW.webp" ></p>
<p>The last step is to install this new apk and run it. Now, the flag will
appear after scanning the QR code. With that, we completed the
challenge.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="484" height="158" src="https://danielorihuela.dev/_astro/intro.CKtRuOxm_1oltDp.webp" ></p>  </div> </article> <footer></footer> </body></html>