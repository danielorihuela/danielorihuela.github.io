<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.15.4"><!-- Canonical URL --><link rel="canonical" href="https://danielorihuela.github.io/blog/h4ck1ng-g00gl3-ep000ch01/"><!-- Primary Meta Tags --><title>H4ck1ng G00gl3 ep000 challenge 01</title><meta name="title" content="H4ck1ng G00gl3 ep000 challenge 01"><meta name="description" content="Think like a hacker to solve H4ck1ng G00gl3 ep000 challenge 01. Use SQL
injection to outsmart the AI in this web exploitation adventure.
"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://danielorihuela.github.io/blog/h4ck1ng-g00gl3-ep000ch01/"><meta property="og:title" content="H4ck1ng G00gl3 ep000 challenge 01"><meta property="og:description" content="Think like a hacker to solve H4ck1ng G00gl3 ep000 challenge 01. Use SQL
injection to outsmart the AI in this web exploitation adventure.
"><meta property="og:image" content="https://danielorihuela.github.io/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://danielorihuela.github.io/blog/h4ck1ng-g00gl3-ep000ch01/"><meta property="twitter:title" content="H4ck1ng G00gl3 ep000 challenge 01"><meta property="twitter:description" content="Think like a hacker to solve H4ck1ng G00gl3 ep000 challenge 01. Use SQL
injection to outsmart the AI in this web exploitation adventure.
"><meta property="twitter:image" content="https://danielorihuela.github.io/blog-placeholder-1.jpg"><link rel="stylesheet" href="/_astro/_slug_.BVZF4iwd.css">
<style>code[class*=language-],pre[class*=language-]{color:#f5f5f5;text-shadow:0 0 2px #100c0f,0 0 5px rgba(220,7,142,.2),0 0 10px rgba(255,255,255,.2);background:none;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#34294f}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#969896}.token.punctuation{color:#ccc}.token.selector{color:#72f1b8;text-shadow:0 0 2px #100c0f,0 0 10px rgba(37,124,85,.4588235294),0 0 35px rgba(33,39,36,.4588235294)}.token.function-name{color:#6196cc}.token.constant,.token.symbol{color:#f92aad;text-shadow:0 0 2px #100c0f,0 0 5px rgba(220,7,142,.2),0 0 10px rgba(255,255,255,.2)}.token.attr-value,.token.char,.token.regex,.token.variable{color:#f87c32}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.token.string{color:#90ee90}.token.class-name,.token.deleted,.token.directive.keyword+.token.string,.token.hexcode,.token.namespace,.token.tag,.token.unit{color:#fff;text-shadow:0 0 1px #ff4d4d,0 0 2px #ff4d4d,0 0 4px #ff4d4d,0 0 10px #ff4d4d,0 0 20px #ff4d4d}.token.macro{color:#fff;text-shadow:0 0 1px #f8d132,0 0 2px #f8d132,0 0 4px #f8d132,0 0 10px #f8d132,0 0 20px #f8d132}.token.attr-name,.token.boolean,.token.function,.token.selector .token.id{color:#fff;text-shadow:0 0 1px #00f2ff,0 0 2px #00f2ff,0 0 4px #00f2ff,0 0 10px #00f2ff,0 0 20px #00f2ff}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector .token.class,.token.token.directive-hash{color:#fff;text-shadow:0 0 1px #bd32f8,0 0 2px #bd32f8,0 0 4px #bd32f8,0 0 10px #bd32f8,0 0 20px #bd32f8}main[data-astro-cid-bvzihdzo]{width:100%;background-color:#222}.hero-image[data-astro-cid-bvzihdzo]{width:40ch;max-width:100%;margin:auto}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-bvzihdzo]{width:80ch;max-width:100%;margin:auto;color:#d3d3d3}.title[data-astro-cid-bvzihdzo]{margin-bottom:1rem;padding:1rem 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5rem}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5rem;color:#fff}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}.title-name[data-astro-cid-bvzihdzo]{font-family:Iceland;color:#fff}.prose[data-astro-cid-bvzihdzo] img{display:flex;margin:0 auto 2em}.prose[data-astro-cid-bvzihdzo] p{margin-bottom:2em}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Home </a>  <a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> About </a>  <a href="/blog" class="active" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blog </a>  <a href="/open-source" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Open Source </a>  </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo> <img src="/_astro/hacking-google-2022.Cm7LR77H_Z4aiM2.webp" alt="" data-astro-cid-bvzihdzo width="1024" height="1024" loading="lazy" decoding="async"> </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2022-10-18T00:00:00.000Z"> Oct 18, 2022 </time>  </div> <h1 class="title-name" data-astro-cid-bvzihdzo>H4ck1ng G00gl3 ep000 challenge 01</h1> <hr data-astro-cid-bvzihdzo> </div>  <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#learning-journey">Learning Journey</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p><a href="https://h4ck1ng.google/">H4ck1ng G00gl3</a> is a series of security
challenges published on <strong>October 2022</strong> where the only way to win is to
think like a hacker. In this post I explain how I solved <strong>ep000
challenge 01</strong>. This challenge is about <strong>Web Exploitation</strong>.</p>
<h1 id="learning-journey">Learning Journey</h1>
<p><img  src="/_astro/intro.DFAYQna-_Z1S6ViT.webp" alt="" width="500" height="177" loading="lazy" decoding="async"></p>
<p>After opening the challenge, we see the following screen.</p>
<p><img  src="/_astro/chess-main-page.Dn6JtnxU_1lMJRb.webp" alt="" width="1864" height="797" loading="lazy" decoding="async"></p>
<p>Winning the game at this point is not the intended way to solve the
challenge. Nevertheless, I tried it :D. The problem is that the AI will
cheat. After some movements, all the AI pawns will become queens.</p>
<p><img  src="/_astro/cheat.BsAFgXFv_9xgYf.webp" alt="" width="492" height="484" loading="lazy" decoding="async"></p>
<p>Out of curiosity, I decided to see the difficulty dropdown even though
the hint said: <code>Don't make this game harder than it needs to be.</code> As I
expected, I did not find anything interesting there.</p>
<p><img  src="/_astro/difficulty.DTkUTxja_Z84ha4.webp" alt="" width="180" height="99" loading="lazy" decoding="async"></p>
<p>It was time to access the <strong>Master Login</strong> area. There, we find a simple
interface asking for the user and the password.</p>
<p><img  src="/_astro/admin-login.N4jn8lNv_ZPvujz.webp" alt="" width="294" height="84" loading="lazy" decoding="async"></p>
<p>I was on a webpage with a login prompt. The first thing that came to
mind was a <strong>SQL Injection</strong>. I did not know if a SQL database was in
use. It was a guess. As an initial step, I tried to log in with a random
username and password to check how a “normal” response would look. In
that case, the website renders a message saying “Invalid Login!” and the
server returns the HTTP status 200.</p>
<p><img  src="/_astro/login-response.DIIo8qST_Zr451f.webp" alt="" width="638" height="278" loading="lazy" decoding="async"></p>
<p>Now, I needed to check if the website was vulnerable to a <strong>SQL
Injection</strong> attack. In SQL, the <strong>single quote character</strong> indicates the
beginning and end of strings. Usually, that is one of the first used
characters to check if a website is vulnerable. If not correctly
filtered, the built query will be incorrect. After entering the <strong>single
quote character</strong> as the username, the server returns the HTTP error
500. Jackpot! We found the vulnerability.</p>
<p>Probably, the SQL query used in the backend is similar to the following:</p>
<pre class="language-sql" data-language="sql"><code is:raw="" class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Users <span class="token keyword">WHERE</span> username <span class="token operator">=</span> <span class="token string">'provided username'</span> <span class="token operator">AND</span> password<span class="token operator">=</span><span class="token string">'provided password'</span><span class="token punctuation">;</span>
</code></pre>
<p>In our case, we have to exploit the username field. The goal is to make
that query return a user. That way, we will log in. Commonly, an admin
user with the username “admin” exists. I tried with a couple of possible
payloads. The one that worked was <strong>admin’ OR ‘1’=‘1</strong>. I did not fill
in the password login field. Replacing the username and password in the
query gives us:</p>
<pre class="language-sql" data-language="sql"><code is:raw="" class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Users <span class="token keyword">WHERE</span> username <span class="token operator">=</span> <span class="token string">'admin'</span> <span class="token operator">OR</span> <span class="token string">'1'</span><span class="token operator">=</span><span class="token string">'1'</span> <span class="token operator">AND</span> password<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>
</code></pre>
<p>That query returns any user with “admin” username or empty password. We
were lucky because all the assumptions held, and we could log in as the
admin user.</p>
<p><img  src="/_astro/admin-panel.DIgfC9ky_ZdiMKq.webp" alt="" width="453" height="139" loading="lazy" decoding="async"></p>
<p>Here, we see a couple of options. The first one is used to change the
<strong>thinking time</strong> of the AI. The second one is to <strong>enable/disable the
AI Queen Cheats</strong>. Immediately, I disabled the AI Queen Cheats and tried
to play a new game. It worked as expected. I could play a full game
without the AI pawns becoming queens. Anyway, I am not a good chess
player. I was still getting wrecked. For that reason, I returned to the
panel and started increasing and decreasing the thinking time of the AI.
In the beginning, I was only using positive numbers. I did not see any
significant difference. I was still losing. At some point, I tried to
decrease the thinking time below zero. The AI was playing worse. It was
moving the pieces in order. First, the AI moved all the pawns until no
pawn could move. Then the knights and so on.</p>
<ol>
<li>Pawns</li>
<li>Knights</li>
<li>Bishops</li>
<li>Rooks</li>
<li>Queen</li>
<li>King</li>
</ol>
<p>That made the game much more predictable. There were only a couple of
exceptions to the previous order. If the King is in check, the AI will
put the King in a safe place or kill your piece. Now, winning the game
was easy. Once you win, the webpage should print the flag on the screen.
With that, we completed the challenge.</p>
<p><img  src="/_astro/intro.DFAYQna-_Z1S6ViT.webp" alt="" width="500" height="177" loading="lazy" decoding="async"></p>  </div> </article> </main> <footer></footer> </body></html>