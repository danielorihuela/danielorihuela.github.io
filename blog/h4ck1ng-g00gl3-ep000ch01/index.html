<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/me.svg"><meta name="generator" content="Astro v4.15.4"><!-- Canonical URL --><link rel="canonical" href="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch01/"><!-- Primary Meta Tags --><title>H4ck1ng G00gl3 ep000 challenge 01</title><meta name="title" content="H4ck1ng G00gl3 ep000 challenge 01"><meta name="description" content="Think like a hacker to solve H4ck1ng G00gl3 ep000 challenge 01. Use SQL injection to outsmart the AI in this web exploitation adventure."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch01/"><meta property="og:title" content="H4ck1ng G00gl3 ep000 challenge 01"><meta property="og:description" content="Think like a hacker to solve H4ck1ng G00gl3 ep000 challenge 01. Use SQL injection to outsmart the AI in this web exploitation adventure."><meta property="og:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch01/"><meta property="twitter:title" content="H4ck1ng G00gl3 ep000 challenge 01"><meta property="twitter:description" content="Think like a hacker to solve H4ck1ng G00gl3 ep000 challenge 01. Use SQL injection to outsmart the AI in this web exploitation adventure."><meta property="twitter:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- RSS --><link rel="alternate" type="application/rss+xml" title="Daniel Orihuela" href="https://danielorihuela.dev/feed.xml"><link rel="stylesheet" href="/_astro/about.BdnWl1ph.css">
<link rel="stylesheet" href="/_astro/_slug_.wqGeQQNF.css">
<style>img{margin:0 auto}div+h1{margin-top:0}h1,h2,h3,h4,h5,h6{margin-top:1em}
</style><script type="module" src="/_astro/hoisted.DNq6m-fi.js"></script></head> <body class="bg-black bg-gradient-to-b from-black to-gray-900w-screen bg-black bg-gradient-to-b from-black to-gray-900"> <header class="px-4 py-0"> <nav class="fixed top-0 left-0 right-0 z-50 transition-all duration-500 bg-black/90 backdrop-blur-md border-b border-royalPurple/50"> <div class="max-w-7xl mx-auto px-6 lg:px-8"> <div class="flex items-center justify-between h-20">  <a href="/" class="text-2xl font-bold text-white hover:text-cyan-400 transition-colors duration-300"> <span class="text-royalPurple">&lt;</span>
DO
<span class="text-royalPurple">/&gt;</span> </a>  <div class="hidden md:flex items-center space-x-8"> <a href="/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Home <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/about" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> About <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/blog" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Blog <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/open-source" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Open Source <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a> </div>  <button id="mobile-menu-button" class="md:hidden text-white hover:text-cyan-400 transition-colors duration-300"> <svg id="menu-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"> <path id="menu-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path> </svg> </button> </div>  <div id="mobile-menu" class="md:hidden transition-all duration-300 overflow-hidden max-h-0 opacity-0"> <div class="py-4 space-y-2 bg-black/95 backdrop-blur-md rounded-lg mt-2 border border-purple-900/30"> <a href="/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Home </a><a href="/about" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> About </a><a href="/blog" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Blog </a><a href="/open-source" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Open Source </a> </div> </div> </div> </nav>  </header> <article class="my-32"> <div class="w-[80ch] max-w-full m-auto text-[#d3d3d3] bg-[#222222] rounded-2xl p-8 lg:p-12 border border-gray-600/30 shadow-2xl prose prose-xl prose-invert max-w-none"> <div class="w-96 max-w-full m-auto"> <img src="/_astro/hacking-google-2022.Cm7LR77H_Z4aiM2.webp" class="rounded-xl shadow-ba" alt="" width="1024" height="1024" loading="lazy" decoding="async"> </div> <div class="py-4 text-center leading-none"> <div class="mb-2 text-[#ffffff]"> <time datetime="2022-10-18T00:00:00.000Z"> Oct 18, 2022 </time> </div> <h1 class="font-[Iceland]"> H4ck1ng G00gl3 ep000 challenge 01 </h1> <hr> </div>  <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#learning-journey">Learning Journey</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p><a href="https://h4ck1ng.google/">H4ck1ng G00gl3</a> is a series of security
challenges published on <strong>October 2022</strong> where the only way to win is to
think like a hacker. In this post I explain how I solved <strong>ep000
challenge 01</strong>. This challenge is about <strong>Web Exploitation</strong>.</p>
<h1 id="learning-journey">Learning Journey</h1>
<p><img  src="/_astro/intro.DFAYQna-_Z1S6ViT.webp" alt="" width="500" height="177" loading="lazy" decoding="async"></p>
<p>After opening the challenge, we see the following screen.</p>
<p><img  src="/_astro/chess-main-page.Dn6JtnxU_1lMJRb.webp" alt="" width="1864" height="797" loading="lazy" decoding="async"></p>
<p>Winning the game at this point is not the intended way to solve the
challenge. Nevertheless, I tried it :D. The problem is that the AI will
cheat. After some movements, all the AI pawns will become queens.</p>
<p><img  src="/_astro/cheat.BsAFgXFv_9xgYf.webp" alt="" width="492" height="484" loading="lazy" decoding="async"></p>
<p>Out of curiosity, I decided to see the difficulty dropdown even though
the hint said: <code>Don't make this game harder than it needs to be.</code> As I
expected, I did not find anything interesting there.</p>
<p><img  src="/_astro/difficulty.DTkUTxja_Z84ha4.webp" alt="" width="180" height="99" loading="lazy" decoding="async"></p>
<p>It was time to access the <strong>Master Login</strong> area. There, we find a simple
interface asking for the user and the password.</p>
<p><img  src="/_astro/admin-login.N4jn8lNv_ZPvujz.webp" alt="" width="294" height="84" loading="lazy" decoding="async"></p>
<p>I was on a webpage with a login prompt. The first thing that came to
mind was a <strong>SQL Injection</strong>. I did not know if a SQL database was in
use. It was a guess. As an initial step, I tried to log in with a random
username and password to check how a “normal” response would look. In
that case, the website renders a message saying “Invalid Login!” and the
server returns the HTTP status 200.</p>
<p><img  src="/_astro/login-response.DIIo8qST_Zr451f.webp" alt="" width="638" height="278" loading="lazy" decoding="async"></p>
<p>Now, I needed to check if the website was vulnerable to a <strong>SQL
Injection</strong> attack. In SQL, the <strong>single quote character</strong> indicates the
beginning and end of strings. Usually, that is one of the first used
characters to check if a website is vulnerable. If not correctly
filtered, the built query will be incorrect. After entering the <strong>single
quote character</strong> as the username, the server returns the HTTP error
500. Jackpot! We found the vulnerability.</p>
<p>Probably, the SQL query used in the backend is similar to the following:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#FF79C6"> *</span><span style="color:#FF79C6"> FROM</span><span style="color:#F8F8F2"> Users </span><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> username </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">provided username</span><span style="color:#E9F284">'</span><span style="color:#FF79C6"> AND</span><span style="color:#FF79C6"> password=</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">provided password</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span></code></pre>
<p>In our case, we have to exploit the username field. The goal is to make
that query return a user. That way, we will log in. Commonly, an admin
user with the username “admin” exists. I tried with a couple of possible
payloads. The one that worked was <strong>admin’ OR ‘1’=‘1</strong>. I did not fill
in the password login field. Replacing the username and password in the
query gives us:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#FF79C6"> *</span><span style="color:#FF79C6"> FROM</span><span style="color:#F8F8F2"> Users </span><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> username </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">admin</span><span style="color:#E9F284">'</span><span style="color:#FF79C6"> OR</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">'</span><span style="color:#FF79C6"> AND</span><span style="color:#FF79C6"> password=</span><span style="color:#E9F284">''</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span></code></pre>
<p>That query returns any user with “admin” username or empty password. We
were lucky because all the assumptions held, and we could log in as the
admin user.</p>
<p><img  src="/_astro/admin-panel.DIgfC9ky_ZdiMKq.webp" alt="" width="453" height="139" loading="lazy" decoding="async"></p>
<p>Here, we see a couple of options. The first one is used to change the
<strong>thinking time</strong> of the AI. The second one is to <strong>enable/disable the
AI Queen Cheats</strong>. Immediately, I disabled the AI Queen Cheats and tried
to play a new game. It worked as expected. I could play a full game
without the AI pawns becoming queens. Anyway, I am not a good chess
player. I was still getting wrecked. For that reason, I returned to the
panel and started increasing and decreasing the thinking time of the AI.
In the beginning, I was only using positive numbers. I did not see any
significant difference. I was still losing. At some point, I tried to
decrease the thinking time below zero. The AI was playing worse. It was
moving the pieces in order. First, the AI moved all the pawns until no
pawn could move. Then the knights and so on.</p>
<ol>
<li>Pawns</li>
<li>Knights</li>
<li>Bishops</li>
<li>Rooks</li>
<li>Queen</li>
<li>King</li>
</ol>
<p>That made the game much more predictable. There were only a couple of
exceptions to the previous order. If the King is in check, the AI will
put the King in a safe place or kill your piece. Now, winning the game
was easy. Once you win, the webpage should print the flag on the screen.
With that, we completed the challenge.</p>
<p><img  src="/_astro/intro.DFAYQna-_Z1S6ViT.webp" alt="" width="500" height="177" loading="lazy" decoding="async"></p>  </div> </article> <footer></footer> </body></html>