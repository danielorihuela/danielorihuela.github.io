<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/me.svg"><meta name="generator" content="Astro v4.15.4"><!-- Canonical URL --><link rel="canonical" href="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch02/"><!-- Primary Meta Tags --><title>H4ck1ng G00gl3 ep000 challenge 02</title><meta name="title" content="H4ck1ng G00gl3 ep000 challenge 02"><meta name="description" content="Hack your way through H4ck1ng G00gl3 ep000 challenge 02. Exploit web
vulnerabilities, master path traversal and Perl code injection, and
claim victory.
"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch02/"><meta property="og:title" content="H4ck1ng G00gl3 ep000 challenge 02"><meta property="og:description" content="Hack your way through H4ck1ng G00gl3 ep000 challenge 02. Exploit web
vulnerabilities, master path traversal and Perl code injection, and
claim victory.
"><meta property="og:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch02/"><meta property="twitter:title" content="H4ck1ng G00gl3 ep000 challenge 02"><meta property="twitter:description" content="Hack your way through H4ck1ng G00gl3 ep000 challenge 02. Exploit web
vulnerabilities, master path traversal and Perl code injection, and
claim victory.
"><meta property="twitter:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><link rel="stylesheet" href="/_astro/_slug_.BVZF4iwd.css">
<style>code[class*=language-],pre[class*=language-]{color:#f5f5f5;text-shadow:0 0 2px #100c0f,0 0 5px rgba(220,7,142,.2),0 0 10px rgba(255,255,255,.2);background:none;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#34294f}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#969896}.token.punctuation{color:#ccc}.token.selector{color:#72f1b8;text-shadow:0 0 2px #100c0f,0 0 10px rgba(37,124,85,.4588235294),0 0 35px rgba(33,39,36,.4588235294)}.token.function-name{color:#6196cc}.token.constant,.token.symbol{color:#f92aad;text-shadow:0 0 2px #100c0f,0 0 5px rgba(220,7,142,.2),0 0 10px rgba(255,255,255,.2)}.token.attr-value,.token.char,.token.regex,.token.variable{color:#f87c32}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.token.string{color:#90ee90}.token.class-name,.token.deleted,.token.directive.keyword+.token.string,.token.hexcode,.token.namespace,.token.tag,.token.unit{color:#fff;text-shadow:0 0 1px #ff4d4d,0 0 2px #ff4d4d,0 0 4px #ff4d4d,0 0 10px #ff4d4d,0 0 20px #ff4d4d}.token.macro{color:#fff;text-shadow:0 0 1px #f8d132,0 0 2px #f8d132,0 0 4px #f8d132,0 0 10px #f8d132,0 0 20px #f8d132}.token.attr-name,.token.boolean,.token.function,.token.selector .token.id{color:#fff;text-shadow:0 0 1px #00f2ff,0 0 2px #00f2ff,0 0 4px #00f2ff,0 0 10px #00f2ff,0 0 20px #00f2ff}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector .token.class,.token.token.directive-hash{color:#fff;text-shadow:0 0 1px #bd32f8,0 0 2px #bd32f8,0 0 4px #bd32f8,0 0 10px #bd32f8,0 0 20px #bd32f8}main[data-astro-cid-bvzihdzo]{width:100%;background-color:#222}.hero-image[data-astro-cid-bvzihdzo]{width:40ch;max-width:100%;margin:auto}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-bvzihdzo]{width:80ch;max-width:100%;margin:auto;color:#d3d3d3}.title[data-astro-cid-bvzihdzo]{margin-bottom:1rem;padding:1rem 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5rem}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5rem;color:#fff}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}.title-name[data-astro-cid-bvzihdzo]{font-family:Iceland;color:#fff}.prose[data-astro-cid-bvzihdzo] img{display:flex;margin:0 auto 2em}.prose[data-astro-cid-bvzihdzo] p{margin-bottom:2em}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Home </a>  <a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> About </a>  <a href="/blog" class="active" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blog </a>  <a href="/open-source" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Open Source </a>  </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo> <img src="/_astro/hacking-google-2022.Cm7LR77H_Z4aiM2.webp" alt="" data-astro-cid-bvzihdzo width="1024" height="1024" loading="lazy" decoding="async"> </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2022-10-18T00:00:00.000Z"> Oct 18, 2022 </time>  </div> <h1 class="title-name" data-astro-cid-bvzihdzo>H4ck1ng G00gl3 ep000 challenge 02</h1> <hr data-astro-cid-bvzihdzo> </div>  <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#learning-journey">Learning Journey</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p><a href="https://h4ck1ng.google/">H4ck1ng G00gl3</a> is a series of security
challenges published on <strong>October 2022</strong> where the only way to win is to
think like a hacker. In this post, I explain how I solved <strong>ep000
challenge 02</strong>. This challenge is about <strong>Web Exploitation</strong>.</p>
<h1 id="learning-journey">Learning Journey</h1>
<p><img  src="/_astro/intro.C73Yn1CY_ZxEhcz.webp" alt="" width="523" height="176" loading="lazy" decoding="async"></p>
<p>After opening the challenge, we see the log search tool.</p>
<p><img  src="/_astro/log-search-tool.2seKQL8F_hI2P8.webp" alt="" width="549" height="583" loading="lazy" decoding="async"></p>
<p>The Log Search Tool is simple. It has two options. The first one is to
select a file from a predefined list of files. And the second one is to
type the term to find, which has to be at least four characters long.
Lastly, it has a blank square at the bottom where the lines of the file
containing the term will appear.</p>
<p>The webpage does not show anything else. Hence, I decided to check the
requests and see if there was anything interesting. There was nothing
out of the ordinary. Only one post is sent with the chosen file and term
like:
<a href="https://aurora-web.h4ck.ctfcompetition.com/?file=hexdump.txt&#x26;term=aurora">https://aurora-web.h4ck.ctfcompetition.com/?file=hexdump.txt&#x26;term=aurora</a>.
The <strong>file</strong> query string is interesting. If the server does not
validate it, we may be able to read the content of a file other than the
ones in the predefined list, known as the <strong>path traversal attack</strong>. We
can try to see if we can get the <code>root</code> user of the <code>/etc/passwd</code> file,
for example. After a couple of tries, I managed to get some output.
Sending a request to
<a href="https://aurora-web.h4ck.ctfcompetition.com/?file=">https://aurora-web.h4ck.ctfcompetition.com/?file=</a>../../etc/passwd&#x26;term=root
returns <code>root:x:0:0:root:/root:/bin/bash</code>.</p>
<p>At this point, I was stuck. I asked for a hint, and the community told
me to look at the source code of the webpage. There was a comment in the
last line of the code: <code>&#x3C;!--/src.txt--></code>. This file is freely
accessible.</p>
<p><img  src="/_astro/perl-vulnerability.CgreVinL_Z1cHJKF.webp" alt="" width="754" height="952" loading="lazy" decoding="async"></p>
<p>As you can see in the image, we have the server source code. It is
written in Perl. Besides, notice what is inside the red rectangle. That
line of code could be potentially vulnerable. At least, that is what the
comment suggests. I was not aware of any vulnerability. Therefore, I
searched for “perl open vulnerability” on Google. The <code>open</code> function
variant of Perl that uses two arguments is susceptible to code
injection. That means that we can execute arbitrary commands. However,
we need to use the correct payload. I had a hard time building it, but I
found an
<a href="https://perl-begin.org/topics/security/code-markup-injection/">example</a>.
As a first step, I managed to print a message.</p>
<p><img  src="/_astro/execute-hello.D4b2MyFZ_21bPWI.webp" alt="" width="933" height="73" loading="lazy" decoding="async"></p>
<p>In the same line, we could execute much more complex commands. For
example, we could list all the files in a directory. But remember that
to print it, we need the line to contain the <strong>term</strong> query string
value. To solve that, we could add a prefix to each file.</p>
<p><img  src="/_astro/execute-ls.ogAz7f1a_Z1hWvgJ.webp" alt="" width="1263" height="454" loading="lazy" decoding="async"></p>
<p>The previous image shows all the files contained in the root directory.
We can see that one of the files is called <code>flag</code>. Similarly, we can
read the contents of the file sending a request with the <strong>term</strong> and
<strong>file</strong> query strings equal to <code>solve</code> and <code>|cat%20/flag|</code>. With that,
we completed the challenge.</p>
<p><img  src="/_astro/intro.C73Yn1CY_ZxEhcz.webp" alt="" width="523" height="176" loading="lazy" decoding="async"></p>  </div> </article> </main> <footer></footer> </body></html>