<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/me.svg"><meta name="generator" content="Astro v4.15.4"><!-- Canonical URL --><link rel="canonical" href="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch02/"><!-- Primary Meta Tags --><title>H4ck1ng G00gl3 ep000 challenge 02</title><meta name="title" content="H4ck1ng G00gl3 ep000 challenge 02"><meta name="description" content="Hack your way through H4ck1ng G00gl3 ep000 challenge 02. Exploit web vulnerabilities, master path traversal and Perl code injection, and claim victory."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch02/"><meta property="og:title" content="H4ck1ng G00gl3 ep000 challenge 02"><meta property="og:description" content="Hack your way through H4ck1ng G00gl3 ep000 challenge 02. Exploit web vulnerabilities, master path traversal and Perl code injection, and claim victory."><meta property="og:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep000ch02/"><meta property="twitter:title" content="H4ck1ng G00gl3 ep000 challenge 02"><meta property="twitter:description" content="Hack your way through H4ck1ng G00gl3 ep000 challenge 02. Exploit web vulnerabilities, master path traversal and Perl code injection, and claim victory."><meta property="twitter:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- RSS --><link rel="alternate" type="application/rss+xml" title="Daniel Orihuela" href="https://danielorihuela.dev/feed.xml"><link rel="stylesheet" href="/_astro/about.BdnWl1ph.css">
<link rel="stylesheet" href="/_astro/_slug_.wqGeQQNF.css">
<style>img{margin:0 auto}div+h1{margin-top:0}h1,h2,h3,h4,h5,h6{margin-top:1em}
</style><script type="module" src="/_astro/hoisted.DNq6m-fi.js"></script></head> <body class="bg-black bg-gradient-to-b from-black to-gray-900w-screen bg-black bg-gradient-to-b from-black to-gray-900"> <header class="px-4 py-0"> <nav class="fixed top-0 left-0 right-0 z-50 transition-all duration-500 bg-black/90 backdrop-blur-md border-b border-royalPurple/50"> <div class="max-w-7xl mx-auto px-6 lg:px-8"> <div class="flex items-center justify-between h-20">  <a href="/" class="text-2xl font-bold text-white hover:text-cyan-400 transition-colors duration-300"> <span class="text-royalPurple">&lt;</span>
DO
<span class="text-royalPurple">/&gt;</span> </a>  <div class="hidden md:flex items-center space-x-8"> <a href="/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Home <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/about" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> About <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/blog" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Blog <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/open-source" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Open Source <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a> </div>  <button id="mobile-menu-button" class="md:hidden text-white hover:text-cyan-400 transition-colors duration-300"> <svg id="menu-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"> <path id="menu-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path> </svg> </button> </div>  <div id="mobile-menu" class="md:hidden transition-all duration-300 overflow-hidden max-h-0 opacity-0"> <div class="py-4 space-y-2 bg-black/95 backdrop-blur-md rounded-lg mt-2 border border-purple-900/30"> <a href="/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Home </a><a href="/about" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> About </a><a href="/blog" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Blog </a><a href="/open-source" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Open Source </a> </div> </div> </div> </nav>  </header> <article class="my-32"> <div class="w-[80ch] max-w-full m-auto text-[#d3d3d3] bg-[#222222] rounded-2xl p-8 lg:p-12 border border-gray-600/30 shadow-2xl prose prose-xl prose-invert max-w-none"> <div class="w-96 max-w-full m-auto"> <img src="/_astro/hacking-google-2022.Cm7LR77H_Z4aiM2.webp" class="rounded-xl shadow-ba" alt="" width="1024" height="1024" loading="lazy" decoding="async"> </div> <div class="py-4 text-center leading-none"> <div class="mb-2 text-[#ffffff]"> <time datetime="2022-10-18T00:00:00.000Z"> Oct 18, 2022 </time> </div> <h1 class="font-[Iceland]"> H4ck1ng G00gl3 ep000 challenge 02 </h1> <hr> </div>  <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#learning-journey">Learning Journey</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p><a href="https://h4ck1ng.google/">H4ck1ng G00gl3</a> is a series of security
challenges published on <strong>October 2022</strong> where the only way to win is to
think like a hacker. In this post, I explain how I solved <strong>ep000
challenge 02</strong>. This challenge is about <strong>Web Exploitation</strong>.</p>
<h1 id="learning-journey">Learning Journey</h1>
<p><img  src="/_astro/intro.C73Yn1CY_ZxEhcz.webp" alt="" width="523" height="176" loading="lazy" decoding="async"></p>
<p>After opening the challenge, we see the log search tool.</p>
<p><img  src="/_astro/log-search-tool.2seKQL8F_hI2P8.webp" alt="" width="549" height="583" loading="lazy" decoding="async"></p>
<p>The Log Search Tool is simple. It has two options. The first one is to
select a file from a predefined list of files. And the second one is to
type the term to find, which has to be at least four characters long.
Lastly, it has a blank square at the bottom where the lines of the file
containing the term will appear.</p>
<p>The webpage does not show anything else. Hence, I decided to check the
requests and see if there was anything interesting. There was nothing
out of the ordinary. Only one post is sent with the chosen file and term
like:
<a href="https://aurora-web.h4ck.ctfcompetition.com/?file=hexdump.txt&#x26;term=aurora">https://aurora-web.h4ck.ctfcompetition.com/?file=hexdump.txt&#x26;term=aurora</a>.
The <strong>file</strong> query string is interesting. If the server does not
validate it, we may be able to read the content of a file other than the
ones in the predefined list, known as the <strong>path traversal attack</strong>. We
can try to see if we can get the <code>root</code> user of the <code>/etc/passwd</code> file,
for example. After a couple of tries, I managed to get some output.
Sending a request to
<a href="https://aurora-web.h4ck.ctfcompetition.com/?file=">https://aurora-web.h4ck.ctfcompetition.com/?file=</a>../../etc/passwd&#x26;term=root
returns <code>root:x:0:0:root:/root:/bin/bash</code>.</p>
<p>At this point, I was stuck. I asked for a hint, and the community told
me to look at the source code of the webpage. There was a comment in the
last line of the code: <code>&#x3C;!--/src.txt--></code>. This file is freely
accessible.</p>
<p><img  src="/_astro/perl-vulnerability.CgreVinL_Z1cHJKF.webp" alt="" width="754" height="952" loading="lazy" decoding="async"></p>
<p>As you can see in the image, we have the server source code. It is
written in Perl. Besides, notice what is inside the red rectangle. That
line of code could be potentially vulnerable. At least, that is what the
comment suggests. I was not aware of any vulnerability. Therefore, I
searched for “perl open vulnerability” on Google. The <code>open</code> function
variant of Perl that uses two arguments is susceptible to code
injection. That means that we can execute arbitrary commands. However,
we need to use the correct payload. I had a hard time building it, but I
found an
<a href="https://perl-begin.org/topics/security/code-markup-injection/">example</a>.
As a first step, I managed to print a message.</p>
<p><img  src="/_astro/execute-hello.D4b2MyFZ_21bPWI.webp" alt="" width="933" height="73" loading="lazy" decoding="async"></p>
<p>In the same line, we could execute much more complex commands. For
example, we could list all the files in a directory. But remember that
to print it, we need the line to contain the <strong>term</strong> query string
value. To solve that, we could add a prefix to each file.</p>
<p><img  src="/_astro/execute-ls.ogAz7f1a_Z1hWvgJ.webp" alt="" width="1263" height="454" loading="lazy" decoding="async"></p>
<p>The previous image shows all the files contained in the root directory.
We can see that one of the files is called <code>flag</code>. Similarly, we can
read the contents of the file sending a request with the <strong>term</strong> and
<strong>file</strong> query strings equal to <code>solve</code> and <code>|cat%20/flag|</code>. With that,
we completed the challenge.</p>
<p><img  src="/_astro/intro.C73Yn1CY_ZxEhcz.webp" alt="" width="523" height="176" loading="lazy" decoding="async"></p>  </div> </article> <footer></footer> </body></html>