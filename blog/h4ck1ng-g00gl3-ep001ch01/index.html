<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.15.4"><!-- Canonical URL --><link rel="canonical" href="https://danielorihuela.github.io/blog/h4ck1ng-g00gl3-ep001ch01/"><!-- Primary Meta Tags --><title>H4ck1ng G00gl3 ep001 challenge 01</title><meta name="title" content="H4ck1ng G00gl3 ep001 challenge 01"><meta name="description" content="todo"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://danielorihuela.github.io/blog/h4ck1ng-g00gl3-ep001ch01/"><meta property="og:title" content="H4ck1ng G00gl3 ep001 challenge 01"><meta property="og:description" content="todo"><meta property="og:image" content="https://danielorihuela.github.io/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://danielorihuela.github.io/blog/h4ck1ng-g00gl3-ep001ch01/"><meta property="twitter:title" content="H4ck1ng G00gl3 ep001 challenge 01"><meta property="twitter:description" content="todo"><meta property="twitter:image" content="https://danielorihuela.github.io/blog-placeholder-1.jpg"><link rel="stylesheet" href="/_astro/_slug_.BVPmWECA.css">
<style>code[class*=language-],pre[class*=language-]{color:#f5f5f5;text-shadow:0 0 2px #100c0f,0 0 5px rgba(220,7,142,.2),0 0 10px rgba(255,255,255,.2);background:none;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#34294f}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#969896}.token.punctuation{color:#ccc}.token.selector{color:#72f1b8;text-shadow:0 0 2px #100c0f,0 0 10px rgba(37,124,85,.4588235294),0 0 35px rgba(33,39,36,.4588235294)}.token.function-name{color:#6196cc}.token.constant,.token.symbol{color:#f92aad;text-shadow:0 0 2px #100c0f,0 0 5px rgba(220,7,142,.2),0 0 10px rgba(255,255,255,.2)}.token.attr-value,.token.char,.token.regex,.token.variable{color:#f87c32}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.token.string{color:#90ee90}.token.class-name,.token.deleted,.token.directive.keyword+.token.string,.token.hexcode,.token.namespace,.token.tag,.token.unit{color:#fff;text-shadow:0 0 1px #ff4d4d,0 0 2px #ff4d4d,0 0 4px #ff4d4d,0 0 10px #ff4d4d,0 0 20px #ff4d4d}.token.macro{color:#fff;text-shadow:0 0 1px #f8d132,0 0 2px #f8d132,0 0 4px #f8d132,0 0 10px #f8d132,0 0 20px #f8d132}.token.attr-name,.token.boolean,.token.function,.token.selector .token.id{color:#fff;text-shadow:0 0 1px #00f2ff,0 0 2px #00f2ff,0 0 4px #00f2ff,0 0 10px #00f2ff,0 0 20px #00f2ff}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector .token.class,.token.token.directive-hash{color:#fff;text-shadow:0 0 1px #bd32f8,0 0 2px #bd32f8,0 0 4px #bd32f8,0 0 10px #bd32f8,0 0 20px #bd32f8}main[data-astro-cid-bvzihdzo]{width:100%;background-color:#222}.hero-image[data-astro-cid-bvzihdzo]{width:40ch;max-width:100%;margin:auto}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-bvzihdzo]{width:80ch;max-width:100%;margin:auto;color:#d3d3d3}.title[data-astro-cid-bvzihdzo]{margin-bottom:1rem;padding:1rem 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5rem}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5rem;color:#fff}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}.title-name[data-astro-cid-bvzihdzo]{font-family:Iceland;color:#fff}.prose[data-astro-cid-bvzihdzo] img{display:flex;margin:0 auto 2em}.prose[data-astro-cid-bvzihdzo] p{margin-bottom:2em}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Home </a>  <a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> About </a>  <a href="/blog" class="active" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blog </a>  <a href="/open-source" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Open Source </a>  </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo> <img src="/_astro/hacking-google-2022.Cm7LR77H_Z4aiM2.webp" alt="" data-astro-cid-bvzihdzo width="1024" height="1024" loading="lazy" decoding="async"> </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2022-10-18T00:00:00.000Z"> Oct 18, 2022 </time>  </div> <h1 class="title-name" data-astro-cid-bvzihdzo>H4ck1ng G00gl3 ep001 challenge 01</h1> <hr data-astro-cid-bvzihdzo> </div>  <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#learning-journey">Learning Journey</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p><a href="https://h4ck1ng.google/">H4ck1ng G00gl3</a> is a series of security
challenges published on <strong>October 2022</strong> where the only way to win is to
think like a hacker. In this post, I explain how I solved <strong>ep001
challenge 01</strong>. This challenge is about <strong>Reverse Engineering</strong>.</p>
<h1 id="learning-journey">Learning Journey</h1>
<p><img  src="/_astro/intro.BkNKMtOl_BotD1.webp" alt="" width="405" height="162" loading="lazy" decoding="async"></p>
<p>After opening the challenge, we get a zip file. This zip file contains
another compressed file that includes two files. We have the flag, even
though we cannot read it yet. It is in binary. And an executable with
the name wannacry.</p>
<p><img  src="/_astro/wannacry-manpage.BI_4aiBP_ZW7QXu.webp" alt="" width="368" height="93" loading="lazy" decoding="async"></p>
<p>The wannacry executable takes an encrypted file and the encryption key
as arguments. We already have the encrypted file, in other words, the
flag file. However, we are missing the private key. The executable must
have some information about that. For that reason, I decided to extract
all the strings from the executable and see if there was something
interesting. To do that, we can use the “strings” command in Linux.</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash">strings wannacry
</code></pre>
<p>At first, I was reading the output. It was huge, and most of the
extracted strings were gibberish. This approach was not good. Then, I
searched for some keywords: flag, private, public, solve, decrypt,
encrypt, etc. The keyword “key” lead me to a domain.</p>
<p><img  src="/_astro/http-with-pems.BnrkLuu0_Ir5g9.webp" alt="" width="510" height="249" loading="lazy" decoding="async"></p>
<p>I visited this domain and saw a list of private keys with long
alphanumeric names. I did not have any hint about which of these private
keys could be the one that I needed. Anyway, there were only around two
hundred private keys. Therefore, we should be able to decrypt the flag
file with every single private key in a small amount of time. With that
strategy in mind, I downloaded all the private keys.</p>
<p>First, we need to obtain a list with the filenames of every private key.
We can do that with the following bash line.</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token function">curl</span> https://wannacry-keys-dot-gweb-h4ck1ng-g00gl3.uc.r.appspot.com/ <span class="token punctuation">\</span>
    <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{split($0,a,"\""); print a[2]}'</span> <span class="token operator">></span> pemfilenames
</code></pre>
<p>Now that we have a list of all the filenames. We can download all the
private keys.</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token keyword">for</span> <span class="token for-or-select variable">pemfile</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> pemfilenames<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">wget</span> https://wannacry-keys-dot-gweb-h4ck1ng-g00gl3.uc.r.appspot.com/<span class="token variable">$pemfile</span> <span class="token parameter variable">-P</span> pemkeys
<span class="token keyword">done</span>
</code></pre>
<p>Finally, we can decrypt the flag with every private key file.</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token keyword">for</span> <span class="token for-or-select variable">pem</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> pemkeys<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    ./wannacry <span class="token parameter variable">-encrypted_file</span> flag <span class="token parameter variable">-key_file</span> pemkeys/<span class="token variable">$pem</span>
<span class="token keyword">done</span> <span class="token operator">></span> result
</code></pre>
<p>Now, we can obtain the flag. We only need to get the strings from the
“result” file and find the flag. We can do that with the following bash
command.</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash">strings result<span class="token operator">|</span> <span class="token function">grep</span> solve
</code></pre>
<p>With that, we completed the challenge.</p>
<p><img  src="/_astro/intro.BkNKMtOl_BotD1.webp" alt="" width="405" height="162" loading="lazy" decoding="async"></p>  </div> </article> </main> <footer></footer> </body></html>