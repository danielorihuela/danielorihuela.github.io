<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/me.svg"><meta name="generator" content="Astro v5.12.7"><!-- Canonical URL --><link rel="canonical" href="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep001ch01/"><!-- Primary Meta Tags --><title>H4ck1ng G00gl3 ep001 challenge 01</title><meta name="title" content="H4ck1ng G00gl3 ep001 challenge 01"><meta name="description" content="Reverse engineer your way to solving H4ck1ng G00gl3 ep001 challenge 01. Extract strings, find private keys, and decrypt the flag to crack this challenge."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep001ch01/"><meta property="og:title" content="H4ck1ng G00gl3 ep001 challenge 01"><meta property="og:description" content="Reverse engineer your way to solving H4ck1ng G00gl3 ep001 challenge 01. Extract strings, find private keys, and decrypt the flag to crack this challenge."><meta property="og:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://danielorihuela.dev/blog/h4ck1ng-g00gl3-ep001ch01/"><meta property="twitter:title" content="H4ck1ng G00gl3 ep001 challenge 01"><meta property="twitter:description" content="Reverse engineer your way to solving H4ck1ng G00gl3 ep001 challenge 01. Extract strings, find private keys, and decrypt the flag to crack this challenge."><meta property="twitter:image" content="https://danielorihuela.dev/_astro/hacking-google-2022.Cm7LR77H.png"><!-- RSS --><link rel="alternate" type="application/rss+xml" title="Daniel Orihuela" href="https://danielorihuela.dev/feed.xml"><link rel="stylesheet" href="/_astro/about.BlhpPIz9.css">
<link rel="stylesheet" href="/_astro/_slug_.JRAvWsf2.css">
<style>img{margin:0 auto}div+h1{margin-top:0}h1,h2,h3,h4,h5,h6{margin-top:1em}
</style></head> <body class="bg-black bg-gradient-to-b from-black to-gray-900w-screen bg-black bg-gradient-to-b from-black to-gray-900"> <header class="px-4 py-0"> <nav class="fixed top-0 left-0 right-0 z-50 transition-all duration-500 bg-black/90 backdrop-blur-md border-b border-royalPurple/50"> <div class="max-w-7xl mx-auto px-6 lg:px-8"> <div class="flex items-center justify-between h-20">  <a href="/" class="text-2xl font-bold text-white hover:text-cyan-400 transition-colors duration-300"> <span class="text-royalPurple">&lt;</span>
DO
<span class="text-royalPurple">/&gt;</span> </a>  <div class="hidden md:flex items-center space-x-8"> <a href="/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Home <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/about/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> About <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/blog/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Blog <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a><a href="/open-source/" class="relative px-4 duration-300 group font-[Iceland] text-gray-300 hover:text-white"> Open Source <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-royalPurple to-cyan-400 transform transition-transform duration-300 scale-x-0 group-hover:scale-x-100"></span> </a> </div>  <button id="mobile-menu-button" class="md:hidden text-white hover:text-cyan-400 transition-colors duration-300"> <svg id="menu-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"> <path id="menu-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path> </svg> </button> </div>  <div id="mobile-menu" class="md:hidden transition-all duration-300 overflow-hidden max-h-0 opacity-0"> <div class="py-4 space-y-2 bg-black/95 backdrop-blur-md rounded-lg mt-2 border border-purple-900/30"> <a href="/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Home </a><a href="/about/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> About </a><a href="/blog/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Blog </a><a href="/open-source/" id="menu-item" class="block px-6 py-3 text-sm font-medium transition-colors duration-300 text-gray-300 hover:text-white hover:bg-gray-800/50"> Open Source </a> </div> </div> </div> </nav> <script type="module">document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("mobile-menu-button"),e=document.getElementById("menu-path");!n||!e||n.addEventListener("click",()=>{const t=document.getElementById("mobile-menu");t&&(t.classList.contains("max-h-0")?(t.classList.remove("max-h-0","opacity-0"),t.classList.add("max-h-96","opacity-100"),e.setAttribute("d","M6 18L18 6M6 6l12 12")):(t.classList.remove("max-h-96","opacity-100"),t.classList.add("max-h-0","opacity-0"),e.setAttribute("d","M4 6h16M4 12h16m-7 6h7")))})});</script> </header> <article class="my-32"> <div class="w-[80ch] max-w-full m-auto text-[#d3d3d3] bg-[#222222] rounded-2xl p-8 lg:p-12 border border-gray-600/30 shadow-2xl prose prose-xl prose-invert max-w-none"> <div class="w-96 max-w-full m-auto"> <img src="/_astro/hacking-google-2022.Cm7LR77H_Z2gI9G8.webp" alt loading="lazy" decoding="async" fetchpriority="auto" width="1024" height="1024" class="rounded-xl shadow-ba"> </div> <div class="py-4 text-center leading-none"> <div class="mb-2 text-[#ffffff]"> <time datetime="2022-10-18T00:00:00.000Z"> Oct 18, 2022 </time> </div> <h1 class="font-[Iceland]"> H4ck1ng G00gl3 ep001 challenge 01 </h1> <hr> </div>  <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#learning-journey">Learning Journey</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p><a href="https://h4ck1ng.google/">H4ck1ng G00gl3</a> is a series of security
challenges published on <strong>October 2022</strong> where the only way to win is to
think like a hacker. In this post, I explain how I solved <strong>ep001
challenge 01</strong>. This challenge is about <strong>Reverse Engineering</strong>.</p>
<h1 id="learning-journey">Learning Journey</h1>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="405" height="162" src="/_astro/intro.BkNKMtOl_Z1dQuUK.webp" ></p>
<p>After opening the challenge, we get a zip file. This zip file contains
another compressed file that includes two files. We have the flag, even
though we cannot read it yet. It is in binary. And an executable with
the name wannacry.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="368" height="93" src="/_astro/wannacry-manpage.BI_4aiBP_Z17Cwkj.webp" ></p>
<p>The wannacry executable takes an encrypted file and the encryption key
as arguments. We already have the encrypted file, in other words, the
flag file. However, we are missing the private key. The executable must
have some information about that. For that reason, I decided to extract
all the strings from the executable and see if there was something
interesting. To do that, we can use the “strings” command in Linux.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">strings</span><span style="color:#F1FA8C"> wannacry</span></span></code></pre>
<p>At first, I was reading the output. It was huge, and most of the
extracted strings were gibberish. This approach was not good. Then, I
searched for some keywords: flag, private, public, solve, decrypt,
encrypt, etc. The keyword “key” lead me to a domain.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="510" height="249" src="/_astro/http-with-pems.BnrkLuu0_ZoBsYn.webp" ></p>
<p>I visited this domain and saw a list of private keys with long
alphanumeric names. I did not have any hint about which of these private
keys could be the one that I needed. Anyway, there were only around two
hundred private keys. Therefore, we should be able to decrypt the flag
file with every single private key in a small amount of time. With that
strategy in mind, I downloaded all the private keys.</p>
<p>First, we need to obtain a list with the filenames of every private key.
We can do that with the following bash line.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">curl</span><span style="color:#F1FA8C"> https://wannacry-keys-dot-gweb-h4ck1ng-g00gl3.uc.r.appspot.com/</span><span style="color:#FF79C6"> \</span></span>
<span class="line"><span style="color:#FF79C6">    |</span><span style="color:#50FA7B"> awk</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">{split($0,a,"\""); print a[2]}</span><span style="color:#E9F284">'</span><span style="color:#FF79C6"> ></span><span style="color:#F1FA8C"> pemfilenames</span></span></code></pre>
<p>Now that we have a list of all the filenames. We can download all the
private keys.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#FF79C6">for</span><span style="color:#BD93F9"> pemfile</span><span style="color:#FF79C6"> in</span><span style="color:#F8F8F2"> $(</span><span style="color:#50FA7B">cat</span><span style="color:#F1FA8C"> pemfilenames</span><span style="color:#F8F8F2">); </span><span style="color:#FF79C6">do</span></span>
<span class="line"><span style="color:#50FA7B">    wget</span><span style="color:#F1FA8C"> https://wannacry-keys-dot-gweb-h4ck1ng-g00gl3.uc.r.appspot.com/</span><span style="color:#BD93F9">$pemfile</span><span style="color:#BD93F9"> -P</span><span style="color:#F1FA8C"> pemkeys</span></span>
<span class="line"><span style="color:#FF79C6">done</span></span></code></pre>
<p>Finally, we can decrypt the flag with every private key file.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#FF79C6">for</span><span style="color:#BD93F9"> pem</span><span style="color:#FF79C6"> in</span><span style="color:#F8F8F2"> $(</span><span style="color:#50FA7B">ls</span><span style="color:#F1FA8C"> pemkeys</span><span style="color:#F8F8F2">); </span><span style="color:#FF79C6">do</span></span>
<span class="line"><span style="color:#50FA7B">    ./wannacry</span><span style="color:#BD93F9"> -encrypted_file</span><span style="color:#F1FA8C"> flag</span><span style="color:#BD93F9"> -key_file</span><span style="color:#F1FA8C"> pemkeys/</span><span style="color:#BD93F9">$pem</span></span>
<span class="line"><span style="color:#FF79C6">done</span><span style="color:#FF79C6"> ></span><span style="color:#F8F8F2"> result</span></span></code></pre>
<p>Now, we can obtain the flag. We only need to get the strings from the
“result” file and find the flag. We can do that with the following bash
command.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">strings</span><span style="color:#F1FA8C"> result</span><span style="color:#FF79C6">|</span><span style="color:#50FA7B"> grep</span><span style="color:#F1FA8C"> solve</span></span></code></pre>
<p>With that, we completed the challenge.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="405" height="162" src="/_astro/intro.BkNKMtOl_Z1dQuUK.webp" ></p>  </div> </article> <footer></footer> </body></html>